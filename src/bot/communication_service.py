import logging
from typing import Dict, List

logger = logging.getLogger(__name__)

class CommunicationService:
    """–°–µ—Ä–≤–∏—Å –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏"""
    
    def __init__(self):
        self.templates = {
            'greeting': {
                'strict': "–£–≤–∞–∂–∞–µ–º—ã–π {name}! –ö–æ–º–ø–∞–Ω–∏—è ¬´{company}¬ª —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤–∞—à—É –∫–∞–Ω–¥–∏–¥–∞—Ç—É—Ä—É –Ω–∞ –ø–æ–∑–∏—Ü–∏—é {position}. –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.",
                'friendly': "–ü—Ä–∏–≤–µ—Ç, {name}! üëã –ú—ã –∏–∑ {company} —É–≤–∏–¥–µ–ª–∏ —Ç–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ {position}. –î–∞–≤–∞–π –ø–æ–æ–±—â–∞–µ–º—Å—è –∏ –æ–±—Å—É–¥–∏–º –¥–µ—Ç–∞–ª–∏!",
                'neutral': "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –ö–æ–º–ø–∞–Ω–∏—è {company} –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–∞—Å—å –≤–∞—à–µ–π –∫–∞–Ω–¥–∏–¥–∞—Ç—É—Ä–æ–π –Ω–∞ –ø–æ–∑–∏—Ü–∏—é {position}. –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞."
            },
            'interview': {
                'strict': "–£–≤–∞–∂–∞–µ–º—ã–π {name}! –ü—Ä–∏–≥–ª–∞—à–∞–µ–º –≤–∞—Å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é {position}. –î–∞—Ç–∞: {date}, –≤—Ä–µ–º—è: {time}. –ú–µ—Å—Ç–æ: {location}.",
                'friendly': "–ü—Ä–∏–≤–µ—Ç, {name}! üéâ –û—Ç–ª–∏—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏! –ü—Ä–∏–≥–ª–∞—à–∞–µ–º —Ç–µ–±—è –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ {position}. –î–∞—Ç–∞: {date}, –≤—Ä–µ–º—è: {time}. –ú–µ—Å—Ç–æ: {location}.",
                'neutral': "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –ü—Ä–∏–≥–ª–∞—à–∞–µ–º –≤–∞—Å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é {position}. –î–∞—Ç–∞: {date}, –≤—Ä–µ–º—è: {time}. –ú–µ—Å—Ç–æ: {location}."
            },
            'offer': {
                'strict': "–£–≤–∞–∂–∞–µ–º—ã–π {name}! –ö–æ–º–ø–∞–Ω–∏—è ¬´{company}¬ª –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º –ø–æ–∑–∏—Ü–∏—é {position}. –û–∂–∏–¥–∞–µ–º –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ.",
                'friendly': "–ü—Ä–∏–≤–µ—Ç, {name}! üéä –†–∞–¥—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ç–µ–±–µ –ø–æ–∑–∏—Ü–∏—é {position} –≤ {company}! –ñ–¥–µ–º —Ç–≤–æ–µ–≥–æ –æ—Ç–≤–µ—Ç–∞!",
                'neutral': "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {name}! –ö–æ–º–ø–∞–Ω–∏—è {company} –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤–∞–º –ø–æ–∑–∏—Ü–∏—é {position}. –ü—Ä–æ—Å–∏–º —Å–æ–æ–±—â–∏—Ç—å –æ –≤–∞—à–µ–º —Ä–µ—à–µ–Ω–∏–∏."
            }
        }
    
    def generate_message(self, template_type: str, style: str, **kwargs) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —à–∞–±–ª–æ–Ω—É"""
        try:
            template = self.templates.get(template_type, {}).get(style, self.templates.get(template_type, {}).get('neutral'))
            if not template:
                return f"–°–æ–æ–±—â–µ–Ω–∏–µ: {kwargs}"
            
            return template.format(**kwargs)
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}")
            return f"–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è {kwargs.get('name', '–∫–∞–Ω–¥–∏–¥–∞—Ç–∞')}"

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä
comm = CommunicationService()